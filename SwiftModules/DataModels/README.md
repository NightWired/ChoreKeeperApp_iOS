# DataModels

A Swift module providing data access and repository patterns for the ChoreKeeper iOS application.

## Overview

The DataModels module serves as a layer on top of the Core Data model classes that are auto-generated by Xcode using the "Class Definition" codegen setting. It provides repository patterns, query builders, and business logic for data access and manipulation.

## Features

- **Repository Pattern**: Provides a clean API for CRUD operations on Core Data entities
- **Query Builders**: Simplifies complex Core Data queries with a fluent interface
- **Data Validation**: Ensures data integrity before persistence
- **Relationship Management**: Handles complex entity relationships
- **Transaction Support**: Manages Core Data save contexts and transactions
- **Error Handling**: Provides standardized error handling for data operations
- **Mock Implementations**: Facilitates testing with in-memory data stores

## Architecture

The DataModels module is designed to work with the auto-generated NSManagedObject subclasses from the parent Xcode project. It follows these architectural principles:

1. **Repository Pattern**: Each entity has a corresponding repository that handles CRUD operations
2. **Protocol-Based Design**: All repositories implement protocols for better testability
3. **Dependency Injection**: Services are designed to be injected rather than directly instantiated
4. **Error Standardization**: All data errors are mapped to standardized AppError types

## Core Data Integration

This module is designed to work with the Core Data model that uses "Class Definition" codegen in the parent Xcode project. It does not replace the auto-generated model classes but instead provides a layer on top of them.

## Repositories

The module includes repositories for all Core Data entities:

- UserRepository
- FamilyRepository
- ChoreRepository
- PointRepository
- PointTransactionRepository
- RewardRepository
- PenaltyRepository
- AvatarRepository
- PeriodSettingsRepository

Each repository provides standard CRUD operations as well as entity-specific queries and business logic.

## Usage

### Basic Repository Usage

```swift
import DataModels

// Get a repository instance
let userRepository = UserRepository.shared

// Fetch all users
let users = try userRepository.fetchAll()

// Fetch a specific user
let user = try userRepository.fetch(byId: userId)

// Create a new user
let newUser = try userRepository.create(firstName: "John", lastName: "Doe", username: "johndoe", userType: "child")

// Update a user
try userRepository.update(user, with: ["firstName": "Jane"])

// Delete a user
try userRepository.delete(user)
```

### Query Building

```swift
import DataModels

// Get a repository instance
let choreRepository = ChoreRepository.shared

// Build a complex query
let query = QueryBuilder<Chore>()
    .filter(key: "isCompleted", value: false)
    .filter(key: "dueDate", value: Date(), operator: .lessThanOrEqual)
    .sort(key: "dueDate", ascending: true)
    .limit(10)

// Execute the query
let chores = try choreRepository.fetch(with: query)
```

## Dependencies

- **CoreServices**: Used for logging, configuration, and utility functions
- **ErrorHandler**: Used for standardized error handling

## Requirements

- iOS 15.0+ / macOS 12.0+
- Swift 5.7+
- Xcode 14.0+

## License

This project is proprietary and confidential. Unauthorized copying, transfer, or reproduction of the contents of this module is strictly prohibited.

## Contact

For questions or issues with the DataModels module, please contact the development team.
